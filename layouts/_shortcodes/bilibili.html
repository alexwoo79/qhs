{{- /*
Shortcode to include a Bilibili video.

@param {string} 0 The Bilibili video BV ID (e.g., "BV1xx411c7mV")

@example {{< bilibili "1642023233" >}}
*/ -}}

{{- $bv := .Get 0 -}}
{{- if not $bv -}}
  {{- errorf "Missing Bilibili video ID. Usage: {{< bilibili \"BV_ID\" >}}" -}}
{{- end -}}

<div class="bilibili-video">
  <iframe 
    src="https://player.bilibili.com/player.html?bvid={{ $bv }}&page=1&high_quality=1&danmaku=0" 
    scrolling="no" 
    frameborder="no" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
    allowfullscreen="allowfullscreen"
    sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts">
  </iframe>
</div>

<style>
.bilibili-video {
  position: relative;
  width: 100%;
  padding-bottom: 62.5%; /* 16:10 比例，更适合b站 */
  height: 0;
  overflow: hidden;
  border-radius: 8px;
  margin: 1rem 0;
}

.bilibili-video iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* 适配移动端 */
@media (max-width: 768px) {
  .bilibili-video {
    padding-bottom: 75%; /* 4:3 比例移动端更友好 */
  }
}
</style>
